webpackJsonp([1],{"5Qkr":function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),o=i("sRoY"),n={name:"image_crop",components:{VueCropper:i.n(o).a},props:["img","blob","src"],data:function(){return{cropImg:""}},mounted:function(){"function"==typeof FileReader?((new FileReader).onload=function(e){},window.cropper=this.$refs.cropper,this.$refs.cropper.replace(this.img)):alert("Sorry, FileReader API not supported")},methods:{cropImage:function(){this.cropImg=this.$refs.cropper.getCroppedCanvas().toDataURL(),this.$emit("apply",this.cropImg)},rotate:function(){this.$refs.cropper.rotate(90)}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("hr"),e._v(" "),i("div",[i("vue-cropper",{ref:"cropper",attrs:{guides:!0,"view-mode":1,"drag-mode":"crop","auto-crop-area":.5,"min-container-width":640,"min-container-height":480,background:!0,rotatable:!0,src:e.src,alt:"Исходное фото","img-style":{width:"640px",height:"480px"}}})],1),e._v(" "),e.cropImg?i("img",{staticStyle:{width:"400px",height:"auto"},attrs:{src:e.cropImg,alt:"Обработанное фото"}}):e._e(),e._v(" "),i("br"),e._v(" "),i("br"),e._v(" "),""!=e.src?i("button",{on:{click:function(t){e.$emit("cancel")}}},[e._v("Отменить")]):e._e(),e._v(" "),""!=e.src?i("button",{on:{click:e.cropImage}},[e._v("Применить")]):e._e(),e._v(" "),""!=e.src?i("button",{on:{click:e.rotate}},[e._v("Повернуть")]):e._e()])},staticRenderFns:[]},s={components:{"app-img-crop":i("VU/8")(n,r,!1,null,null,null).exports},name:"app",data:function(){return{video:{},canvas:{},img:"",blob:"",editMode:0,ready_img:null,demo:0}},mounted:function(){this.loadCam()},computed:{img_computed:function(){return this.ready_img?this.ready_img:this.img}},methods:{cancel_handler:function(){this.editMode=0},apply_handler:function(e){this.ready_img=e,this.editMode=0},imageuploaded:function(e){0==e.errcode&&console.log("** RES=>>",e)},edit:function(){var e=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=atob(e),o=[],n=0;n<a.length;n+=i){for(var r=a.slice(n,n+i),s=new Array(r.length),c=0;c<r.length;c++)s[c]=r.charCodeAt(c);var d=new Uint8Array(s);o.push(d)}return new Blob(o,{type:t})}(this.img.replace("data:image/png;base64,",""),"image/png"),t=URL.createObjectURL(e),i=document.createElement("img");i.src=t,this.blob=i,this.editMode=1},del:function(){this.editMode=0,this.img="",this.ready_img="",this.loadCam()},save:function(){alert("Сохранение..."),this.demo=1,this.editMode=0,this.img=""},capture:function(){this.canvas=this.$refs.canvas;this.canvas.getContext("2d").drawImage(this.video,0,0,640,480);this.img=canvas.toDataURL("image/png")},loadCam:function(){var e=this;this.video=this.$refs.video,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.video.src=window.URL.createObjectURL(t),e.video.play()})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"text-center",attrs:{id:"app"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:0==e.demo,expression:"demo==0"}],staticClass:"workspace"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.img,expression:"!img"}]},[i("video",{ref:"video",attrs:{id:"video",width:"640",height:"480",autoplay:""}})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.img,expression:"!img"}]},[i("button",{attrs:{id:"snap"},on:{click:function(t){e.capture()}}},[e._v("Сфотографировать")])]),e._v(" "),i("canvas",{ref:"canvas",attrs:{id:"canvas",width:"640",height:"480"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.img&&0==e.editMode,expression:"img && editMode==0"}]},[i("img",{attrs:{src:e.img_computed,height:"auto"}})]),e._v(" "),e.img&&1==e.editMode?i("div",{attrs:{id:"tui-image-editor"}},[i("app-img-crop",{attrs:{blob:e.blob,img:e.img_computed,src:e.img_computed},on:{cancel:e.cancel_handler,apply:e.apply_handler}})],1):e._e(),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.img,expression:"img"}]},[i("button",{attrs:{id:"snap"},on:{click:e.del}},[e._v("Переснять")]),e._v(" "),0==e.editMode?i("button",{attrs:{id:"snap"},on:{click:e.edit}},[e._v("Редактировать")]):e._e(),e._v(" "),0==e.editMode?i("button",{attrs:{id:"snap"},on:{click:e.save}},[e._v("Сохранить")]):e._e()])]),e._v(" "),1==e.demo?i("div",[i("h1",[e._v("IMAGE to server:")]),e._v(" "),i("textarea",[e._v(e._s(e.img_computed))]),e._v(" "),i("div",[i("button",{on:{click:function(t){e.demo=0}}},[e._v("Запустить камеру")])])]):e._e()])},staticRenderFns:[]};var d=i("VU/8")(s,c,!1,function(e){i("paGW")},null,null).exports;a.default.config.productionTip=!1,new a.default({el:"#app",components:{App:d},template:"<App/>"})},paGW:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.dc9d4e5946b29ec0d4b3.js.map